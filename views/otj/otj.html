<script type="text/ng-template" id="customTemplate.html">
  <a>
      <span bind-html-unsafe="match.label | typeaheadHighlight:query"></span>
      <i>({{match.model.customer_name}})</i>
  </a>
</script>

<div class="page page-oncall" ng-controller="newOtjCustomerCtrl">
<accordion close-others="true" class="ui-accordion ui-accordion-info" id="addCustomer">
	<accordion-group heading="Add OTJ Customer">
			<div class="form-group">
			{{selectedCustomer}}
			
             <input type="text" ng-model="selectedCustomer" placeholder="Search for existing customer here" typeahead="c as c.customer_name for c in customers | filter:$viewValue | limitTo:10" typeahead-min-length='1' typeahead-on-select='onSelectPart($item, $model, $label)' typeahead-template-url="customTemplate.html" class="form-control" style="width:350px;">
			</div>

		<form class="" role="form" id="newCustomerForm" name="newCustomerForm" ng-submit="processNewCustomerForm(selectedCustomer)">
			<div class="form-group">
				<label class="" for="newTitle">Customer Name</label>
				<input  style="display:none" type="text" ng-model="selectedCustomer.customer_id" name="customer_id" class="form-control" id="existing_customer_id" placeholder="Customer Id" >

				<input  type="text" ng-model="selectedCustomer.customer_name" name="customer_name" class="form-control" id="customer_name" placeholder="Enter Customer Name" value="{{somebinding.id}}" required>
			</div>
			<div class="form-group">
				<label class="" for="customerAddress">Customer Address</label>
				<input name="customer_address" ng-model="selectedCustomer.customer_address" type="text" class="form-control"
				       id="customer_address" placeholder="Enter Customer Address" required>
			</div>
			<div class="form-group">
				<label class="" for="customerPhone">Customer Phone</label>
				<input name="customer_phone" ng-model="selectedCustomer.customer_phone" type="text" class="form-control"
				       id="customer_phone" placeholder="Enter Customer Phone Number" required>
			</div>
			<div class="row">
				<div class="col-md-4">
					<label class="ui-checkbox"><input ng-model="new_customer" name="new_customer_chk" type="checkbox" value="option2"><span>Is it a New Customer</span></label>
				</div>
				<div class="col-md-4">
					<label class="ui-checkbox"><input id="existing_customer_chk" ng-model="existing_customer" name="existing_customer" ng-change="change(existing_customer)" type="checkbox"><span>Is it a Existing Customer</span></label>
				</div>
			</div>
			<div class="row">
				<div class="col-md-4">
					<input type="submit" class="btn btn-info" ng-show="new_customer" value="Add New Customer">
				</div>
			</div>	
		</form>
		<form class="" role="form" name="newCustomerForm" ng-submit="createCustomer()">
			<div class="form-group">
				<div class="row">
					<div class="col-md-6">
						<label class="" for="customerId">Customer Id</label><br>
						<input type="text" readonly class="form-control" ng-model="oncallCustomer.customer_id" name="oncallCustomer.existing_customer_id" id="customer_id" required><br>

					</div>
				</div>
				<div class="row">
					<div class="col-sm-6 col-md-4 col-lg-2">
						<label class="" for="newCategory">Enquiry Type</label><br>
								<span class="ui-select">
					                <select id="action_type" ng-model="enquiry_type" required>
										<option value="assessment">Assessment</option>
										<option value="quotation">Quotation</option>
										<option value="followup">Follow Up</option>
					                </select>
					            </span>
					</div>
					<div class="col-sm-6 col-md-4 col-lg-2" ng-show="enquiry_type == 'followup'" style="margin-left: 30px;">
						<label class="" for="newCategory">Follow Up Type</label><br>
						<span class="ui-select">
			                <select id="followup_type" ng-model="follow_up_type">
			                        <option value="delay">Delay</option>
			                        <option value="cancel">Cancel</option>
			                        <option value="confirm">Confirm</option>
			                        required>
			                </select>			            
			            </span>
					</div>

				</div>

				<div class="input-group ui-datepicker">
					<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
					<input type="text"
					       class="form-control"
					       datepicker-popup="dd/MM/yyyy"
					       show-weeks="false"
					       ng-model="enquiry_date"
					       id="enquiry_date" 
					       is-open="opened"
					       min="today"
					       datepicker-options="dateOptions"
					       ng-required="true"
					       close-text="Close">
				</div>
			</div>
			<div class="form-group">
				<label class="" for="newShortDesc">Short Description</label>
				<textarea ng-model="newCoupon.short_description" id="newShortDesc" class="form-control resizeless"
				          rows="2" required data-min="3" data-max="100"></textarea>
			</div>
			<div class="form-group">
				<div class="row">
					<div class="col-sm-6 col-md-4 col-lg-2">
						<label class="" for="serviceName">Service Name</label>
								<span class="ui-select">
					                <select name="oncallCustomer.service_type" ng-model="oncall_services" id="serviceName" ng-options="service.service_name for service in oncall_services_list track by service.service_name" required>
					                	<option value="" ng-hide="oncall_services">Select Service Type</option>
					                </select>
					            </span>
					</div>
					<div class="col-sm-6 col-md-4 col-lg-4" style="margin-left: 30px;">
						<label class="" for="aumPrice">AUM Price</label><br>
						<input style="margin-top: 10px;" ng-model="aumPrice" type="text" class="form-control"
				       id="aumPrice" placeholder="Enter Price" required>		
					</div>
					<div class="col-sm-6 col-md-4 col-lg-2" style="margin-left: 30px;">
						<label class="" for="serviceFrequency">Frequency</label><br>
							<span class="ui-select">
								<select></select>
							</span>		
					</div>
					<div class="col-sm-6 col-md-4 col-lg-2" style="margin-left: 30px;">
						<label class="" for="newShop">Assign This Task to</label><br>
							<span class="ui-select">
					                <select name="oncallCustomer.employee_list" ng-model="employee_list" id="employee_list" ng-options="list_employee.employee_name for list_employee in service_employee_list track by list_employee.employee_id" required>
					                <option value="" ng-hide="employee_list">Select Employee</option>
					                </select>
				            </span>
						
					</div>
				</div>
			</div>


			<hr/>
			<button type="submit" class="btn btn-info">Create Order</button>
		</form>
	</accordion-group>
</accordion>

<section class="panel panel-default table-dynamic">
	<div class="panel-heading"><strong><span class="glyphicon glyphicon-th"></span> OTJ Customer List</strong></div>

	<div class="table-filters">
		<div class="row">
			<div class="col-sm-4 col-xs-6">
				<form>
					<input type="text"
					       placeholder="search"
					       class="form-control"
					       data-ng-model="searchKeywords"
					       data-ng-keyup="search()">
				</form>
			</div>

		</div>
	</div>

	<table class="table table-bordered table-striped table-responsive">
		<thead>
		<tr>
			<th>
				<div class="th">
					ID
				</div>
			</th>
			<th>
				<div class="th">
					Customer Name
                        <span class="glyphicon glyphicon-chevron-up"
                              data-ng-click=" order('shop_by_shop_id.title') "
                              data-ng-class="{active: row == 'shop_by_shop_id.title'}"></span>
                        <span class="glyphicon glyphicon-chevron-down"
                              data-ng-click=" order('-shop_by_shop_id.title') "
                              data-ng-class="{active: row == '-shop_by_shop_id.title'}"></span>
				</div>
			</th>
			<th>
				<div class="th">
					Service Name
                        <span class="glyphicon glyphicon-chevron-up"
                              data-ng-click=" order('categories_by_category_id.title') "
                              data-ng-class="{active: row == 'categories_by_category_id.title'}"></span>
                        <span class="glyphicon glyphicon-chevron-down"
                              data-ng-click=" order('-categories_by_category_id.title') "
                              data-ng-class="{active: row == '-categories_by_category_id.title'}"></span>
				</div>
			</th>
			<th>
				<div class="th">
					Status
				</div>
			</th>
			<th>
				<div class="th">
					Date Of Order
				</div>
			</th>
			<th>
				<div class="th">
					Date Of Service
				</div>
			</th>
			<th>
				<div class="th">
					Assigned To
				</div>
			</th>
			<th>
				<div class="th">
					Invoice Action
				</div>
			</th>
			<th>
				<div class="th">Actions</div>
			</th>
		</tr>
		</thead>
		<tbody>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td><span class="label label-warning"></span></td>
			<td>20-05-2014</td>
			<td>23-05-2014</td>
			<td>Deep Das</td>
			<td><a href="/oncall/invoice" class="btn btn-primary btn-block">Generate Invoice</a></td>
			<td>
				<a ng-href="/oncall/{{coupon.id}}" class="btn-icon btn-icon-sm btn-primary"
				   role="button"
				   tooltip-placement="top" tooltip="Edit" tooltip-append-to-body="true"><i
						class="fa fa-edit"></i></a>
				<a href="javascript:;" class="btn-icon btn-icon-sm btn-danger"
				   ng-dblclick="deleteCoupon(coupon)" role="button"
				   tooltip-placement="top" tooltip="Delete (Double Click)" tooltip-append-to-body="true"><i
						class="fa fa-times"></i></a>
			</td>
		</tr>
		</tbody>
	</table>

	<footer class="table-footer">
		<div class="row">
			<div class="col-md-6 page-num-info">
                    <span>
                        Show
                        <select data-ng-model="numPerPage"
                                data-ng-options="num for num in numPerPageOpt"
                                data-ng-change="onNumPerPageChange()">
                        </select>
                        entries per page
                    </span>
			</div>
			<div class="col-md-6 text-right pagination-container">
				<pagination class="pagination-sm"
		            page="currentPage"
		            total-items="filteredCoupons.length"
		            max-size="4"
		            on-select-page="select(page)"
		            items-per-page="numPerPage"
		            rotate="false"
		            boundary-links="true">
				</pagination>
			</div>
		</div>
	</footer>
</section>
</section>
</div>